<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><title>elanmed.dev</title><meta name="description" content="Mostly a blog, partly a personal website"/><meta name="google-site-verification" content="CE4T4wzf1pNuiL7JwIC9CqNdJyCfsfaNyLjkeFRr9Dc"/><meta name="next-head-count" content="6"/><link rel="preload" href="/_next/static/css/5748d9bdf02ad8f5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5748d9bdf02ad8f5.css" data-n-g=""/><link rel="preload" href="/_next/static/css/2ce50296e403d041.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2ce50296e403d041.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-161b968c28e7461b.js" defer=""></script><script src="/_next/static/chunks/framework-35d22e9fce2190c9.js" defer=""></script><script src="/_next/static/chunks/main-4d4477c6ba0e4c63.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e2759829ed8f82eb.js" defer=""></script><script src="/_next/static/chunks/494-4354f02950fb3485.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-3ad79f7f0c626df0.js" defer=""></script><script src="/_next/static/0UL8ofR2vOLSRgXxs8dK0/_buildManifest.js" defer=""></script><script src="/_next/static/0UL8ofR2vOLSRgXxs8dK0/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div data-theme="cyberpunk"><div class="bg-base-200"><nav class="sticky top-0 z-10 py-3 border-b-2 border-neutral bg-base-100"><main class="flex items-center justify-between w-full px-5"><h3 class="text-lg md:text-2xl font-bold text-primary cursor-pointer"><a href="/">elanmed.dev</a></h3><div><span class="hidden mr-4 text-xs sm:inline">check out my blog! <span class="text-lg text-primary">→</span></span><span class="cursor-pointer select-none hover:underline hover:text-primary transition"><a href="/blog">blog</a></span></div></main></nav><main class="min-h-screen w-full max-w-5xl m-auto py-6 bg-base-100 px-2 md:px-20"><div><div class="pb-2 mb-8 text-sm italic border-b-2 text-primary border-b-base-300 w-max">last updated: <!-- -->August 11, 2022</div><div class="markdown_markdown__28kdH"><h1>VSCode-Style Git Diffs the Vim Way</h1>
<p>The deeper you dive into the Vim black hole, the less you take opinionated editors like VSCode for granted. Nowhere is this more true than when viewing git diffs. In VSCode, you have an elegant interface in the sidebar that shows every change since your last commit as a side-by-side diff. It also has other nice features, like the option to the discard all the changes in a particular file.</p>
<p>Before I switched to Vim, using this feature was an essential part of my workflow. I&#x27;d make a few changes, check the diffs to make sure I got rid of my TODOS, and pushed. It was great.</p>
<p>Unfortunately, it takes a little more work to get something analogous working for Vim.</p>
<h2>My Homegrown Solution</h2>
<p>The solution I stitched together prioritizes moving quickly from file to file, sacrificing the fancier features of VSCode for a low-level approach. In fact, it can be boiled down to just the following bash function:</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-bash" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token function-name" style="color:#ffc66d">gd</span><span> </span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span><span> </span><span class="token" style="color:#a9b7c6">{</span><span>
</span><span>	nvim -p </span><span class="token" style="color:#9876aa">$(</span><span class="token" style="color:#ffc66d">git</span><span class="token" style="color:#9876aa"> </span><span class="token" style="color:#ffc66d">diff</span><span class="token" style="color:#9876aa"> --name-only</span><span class="token" style="color:#9876aa">)</span><span> -c </span><span class="token" style="color:#6a8759">&quot;:tabdo :Gvdiffsplit&quot;</span><span>
</span><span></span><span class="token" style="color:#a9b7c6">}</span></code></div></pre>
<p>Let&#x27;s walk through it chunk by chunk.</p>
<p>First, the <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">-p</code> flag. If we enter <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">nvim --help</code> in the terminal, we can see the following:</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-text" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>-p[N]                 Open N tab pages (default: one per file)</span></code></div></pre>
<p>In our case, we&#x27;re using the result of <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">$(git diff --name-only)</code> as our <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">[N]</code> to determine how many tabs to open in Vim. Looking at the <a href="https://git-scm.com/docs/git-diff">git documentation</a>, we can see that the <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">--name-only</code> flag returns the names of the changed files. In other words, open one tab for each changed file.</p>
<p>With the same <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">nvim --help</code> command, we can see that the <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">-c</code> flag executes its argument as a Vim command:</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-text" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>-c &lt;cmd&gt;      Execute &lt;cmd&gt; after config and first file</span></code></div></pre>
<p>In our case, the command we&#x27;re passing to the <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">-c</code> flag is <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">:tabdo :Gvdiffsplit</code>.</p>
<p>While in Vim, we can enter the command <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">:help :tabdo</code> to get the following info on <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">:tabdo</code>:</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-text" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>:[range]tabd[o] {cmd}
</span>  Execute {cmd} in each tab page ...</code></div></pre>
<p>The command we&#x27;re passing to <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">:tabdo</code> is <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">:Gvdiffsplit</code>, which is from the plugin <a href="https://github.com/tpope/vim-fugitive">vim-fugitive</a>. You can install vim-fugitive with the package-manager of your choice.</p>
<p>In the github documentation for vim-fugitive, we can see the following info on <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">:Gvdiffsplit</code>:</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-text" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>:Gdiffsplit (or :Gvdiffsplit) brings up the staged version of the file side by side with the working tree version.</span></code></div></pre>
<p>Putting everything together, our <code class="inline-block px-3 py-0 text-sm rounded bg-base-300">gd</code> bash function opens a tab for every changed file, and for each tab, opens up a side-by-side git diff.</p>
<p>This homegrown function lacks some of the fancier capabilities of VSCode, but navigating forward is <em>fast</em>. To go from one file to the next, simply exit twice, once for each split! You can even setup a keybinding to make it that much faster.</p>
<pre><div style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code class="language-vim" style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>nnoremap gn </span><span class="token" style="color:#a9b7c6">:</span><span class="token" style="color:#cc7832">q</span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#cc7832">cr</span><span class="token" style="color:#a9b7c6">&gt;</span><span class="token" style="color:#a9b7c6">:</span><span class="token" style="color:#cc7832">q</span><span class="token" style="color:#a9b7c6">&lt;</span><span class="token" style="color:#cc7832">cr</span><span class="token" style="color:#a9b7c6">&gt;</span></code></div></pre>
<p>This function is perfect for taking a last look at your changes before committing.</p>
<h2>Bonus: diffview.nvim</h2>
<p>If you&#x27;re interested in a more batteries-included solution, I&#x27;d recommend checking out <a href="https://github.com/sindrets/diffview.nvim">diffview.nvim</a>. Just like in VSCode, you can view side-by-side diffs of all the files changes since your last commit, with a whole bunch of other bells and whistles. Thank you <a href="https://github.com/sindrets">sindrets</a> and friends!</p></div><div class="w-1/2 divider"></div><div><p class="mb-3 text-sm italic text-primary">you may also like:</p><div class="max-w-[500px] cursor-pointer rounded-2xl flex items-center p-3 gap-3 border-base-100 border-2 hover:border-primary"><div class=""><h2 class="font-semibold mb-1">Data Fetching in React: Parent-Agnostic vs Parent-Dependent Children</h2><p class="text-xs italic mb-2">July 27, 2022</p><p class="text-xs mb-2">Null checking: who should have to do it? The child, or the parent?</p><div><span class="bg-secondary text-secondary-content rounded-full px-4 py-1 text-xs mr-1">react</span><span class="bg-secondary text-secondary-content rounded-full px-4 py-1 text-xs mr-1">software eng</span></div></div></div></div></div></main><footer class="flex justify-center py-4 text-xs border-t-base-300 border-t bg-base-100"><span>© elan medoff</span></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"content":"\n# VSCode-Style Git Diffs the Vim Way\n\nThe deeper you dive into the Vim black hole, the less you take opinionated editors like VSCode for granted. Nowhere is this more true than when viewing git diffs. In VSCode, you have an elegant interface in the sidebar that shows every change since your last commit as a side-by-side diff. It also has other nice features, like the option to the discard all the changes in a particular file.\n\nBefore I switched to Vim, using this feature was an essential part of my workflow. I'd make a few changes, check the diffs to make sure I got rid of my TODOS, and pushed. It was great.\n\nUnfortunately, it takes a little more work to get something analogous working for Vim.\n\n## My Homegrown Solution\n\nThe solution I stitched together prioritizes moving quickly from file to file, sacrificing the fancier features of VSCode for a low-level approach. In fact, it can be boiled down to just the following bash function:\n\n```bash\ngd () {\n\tnvim -p $(git diff --name-only) -c \":tabdo :Gvdiffsplit\"\n}\n```\n\nLet's walk through it chunk by chunk.\n\nFirst, the `-p` flag. If we enter `nvim --help` in the terminal, we can see the following:\n\n```text\n-p[N]                 Open N tab pages (default: one per file)\n```\n\nIn our case, we're using the result of `$(git diff --name-only)` as our `[N]` to determine how many tabs to open in Vim. Looking at the [git documentation](https://git-scm.com/docs/git-diff), we can see that the `--name-only` flag returns the names of the changed files. In other words, open one tab for each changed file.\n\nWith the same `nvim --help` command, we can see that the `-c` flag executes its argument as a Vim command:\n\n```text\n-c \u003ccmd\u003e      Execute \u003ccmd\u003e after config and first file\n```\n\nIn our case, the command we're passing to the `-c` flag is `:tabdo :Gvdiffsplit`.\n\nWhile in Vim, we can enter the command `:help :tabdo` to get the following info on `:tabdo`:\n\n```text\n:[range]tabd[o] {cmd}\n  Execute {cmd} in each tab page ...\n```\n\nThe command we're passing to `:tabdo` is `:Gvdiffsplit`, which is from the plugin [vim-fugitive](https://github.com/tpope/vim-fugitive). You can install vim-fugitive with the package-manager of your choice.\n\nIn the github documentation for vim-fugitive, we can see the following info on `:Gvdiffsplit`:\n\n```text\n:Gdiffsplit (or :Gvdiffsplit) brings up the staged version of the file side by side with the working tree version.\n```\n\nPutting everything together, our `gd` bash function opens a tab for every changed file, and for each tab, opens up a side-by-side git diff.\n\nThis homegrown function lacks some of the fancier capabilities of VSCode, but navigating forward is _fast_. To go from one file to the next, simply exit twice, once for each split! You can even setup a keybinding to make it that much faster.\n\n```vim\nnnoremap gn :q\u003ccr\u003e:q\u003ccr\u003e\n```\n\nThis function is perfect for taking a last look at your changes before committing.\n\n## Bonus: diffview.nvim\n\nIf you're interested in a more batteries-included solution, I'd recommend checking out [diffview.nvim](https://github.com/sindrets/diffview.nvim). Just like in VSCode, you can view side-by-side diffs of all the files changes since your last commit, with a whole bunch of other bells and whistles. Thank you [sindrets](https://github.com/sindrets) and friends!\n","metadata":{"title":"VSCode-Style Git Diffs the Vim Way","abstract":"Check your git diffs with Vim faster than you ever have with VSCode","lastUpdated":"August 11, 2022","slug":"vscode-style-git-diffs-the-vim-way","tags":["software eng","vim"],"priority":0,"collection":null}},"relatedPostMetadata":{"title":"Data Fetching in React: Parent-Agnostic vs Parent-Dependent Children","abstract":"Null checking: who should have to do it? The child, or the parent?","lastUpdated":"July 27, 2022","slug":"parent-dependent-and-parent-agnostic-children","tags":["react","software eng"],"priority":0,"collection":null}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"vscode-style-git-diffs-the-vim-way"},"buildId":"0UL8ofR2vOLSRgXxs8dK0","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>